{"ast":null,"code":"import { CurrenUserContext } from '../contexts/CurrentUserContext.js';\n\nclass Api {\n  constructor(url) {\n    this._getToken = () => localStorage.getItem('jwt');\n\n    this._url = url;\n    this._headers = {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    };\n  }\n\n  _checkServerResponse(res) {\n    if (res.ok) {\n      return res.json();\n    }\n\n    return Promise.reject('Возникла ошибка');\n  }\n\n  getAllNeededData() {\n    return Promise.all([this.getProfile(), this.getInitialCards()]);\n  }\n\n  getInitialCards() {\n    return fetch(`${this._url}/cards/`, {\n      headers: { ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`\n      }\n    }).then(this._checkServerResponse);\n  }\n\n  getProfile() {\n    return fetch(`${this._url}/users/me`, {\n      headers: { ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`\n      }\n    }).then(this._checkServerResponse);\n  }\n\n  addProfile(data) {\n    const body = {\n      data\n    };\n    return fetch(`${this._url}/users/me`, {\n      method: 'PATCH',\n      headers: { ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`\n      },\n      body: JSON.stringify(body)\n    }).then(this._checkServerResponse);\n  }\n\n  addCard(newCard) {\n    const body = {\n      name: newCard.name,\n      link: newCard.link\n    };\n    return fetch(`${this._url}/cards/`, {\n      method: 'POST',\n      headers: { ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`\n      },\n      body: JSON.stringify(body)\n    }).then(this._checkServerResponse);\n  }\n\n  deleteCard(cardId) {\n    return fetch(`${this._url}/cards/${cardId}`, {\n      method: 'DELETE',\n      headers: { ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`\n      }\n    }).then(this._checkServerResponse);\n  }\n\n  changeLikeCardStatus(cardId, isLiked) {\n    return fetch(`${this._url}/cards/${cardId}/likes`, {\n      method: `${isLiked ? 'PUT' : 'DELETE'}`,\n      headers: { ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`\n      }\n    }).then(this._checkServerResponse);\n  }\n\n  addAvatar(data) {\n    const body = {\n      avatar: data.avatar\n    };\n    return fetch(`${this._url}/users/me/avatar`, {\n      method: 'PATCH',\n      headers: { ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`\n      },\n      body: JSON.stringify(body)\n    }).then(this._checkServerResponse);\n  }\n\n}\n\nexport const api = new Api('http://localhost:3000');","map":{"version":3,"names":["CurrenUserContext","Api","constructor","url","_getToken","localStorage","getItem","_url","_headers","_checkServerResponse","res","ok","json","Promise","reject","getAllNeededData","all","getProfile","getInitialCards","fetch","headers","then","addProfile","data","body","method","JSON","stringify","addCard","newCard","name","link","deleteCard","cardId","changeLikeCardStatus","isLiked","addAvatar","avatar","api"],"sources":["C:/Users/mi/dev/react-mesto-api-full/frontend/src/utils/api.js"],"sourcesContent":["import { CurrenUserContext } from '../contexts/CurrentUserContext.js';\n\nclass Api {\n  constructor(url) {\n    this._url = url;\n    this._headers = {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n    }\n  }\n\n  _getToken = () => localStorage.getItem('jwt');\n\n  _checkServerResponse(res){\n    if (res.ok) {\n      return res.json();\n    }\n    return Promise.reject('Возникла ошибка')\n  }\n\n  getAllNeededData() {\n    return Promise.all([this.getProfile(), this.getInitialCards()])\n  }\n\n  getInitialCards() {\n    return fetch(`${this._url}/cards/`, {\n      headers: {\n      ...this._headers,\n      'Authorization': `Bearer ${this._getToken()}`,\n    }\n    })\n      .then(this._checkServerResponse)\n  }\n\n  getProfile() {\n    return fetch(`${this._url}/users/me`, {\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      }\n    })\n      .then(this._checkServerResponse)\n  }\n\n  addProfile(data) {\n    const body = {data}\n    return fetch(`${this._url}/users/me`, {\n      method: 'PATCH',\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      },\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n\n  addCard(newCard) {\n    const body = {\n      name: newCard.name,\n      link: newCard.link\n    }\n    return fetch(`${this._url}/cards/`, {\n      \n      method: 'POST',\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      },\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n\n  deleteCard(cardId) {\n    return fetch(`${this._url}/cards/${cardId}`, {\n      method: 'DELETE',\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      }    })\n    .then(this._checkServerResponse)\n  }\n\n  changeLikeCardStatus(cardId, isLiked) {\n    return fetch(`${this._url}/cards/${cardId}/likes`, {\n      method: `${isLiked ? 'PUT' : 'DELETE'}`,\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      }\n    })\n    .then(this._checkServerResponse)\n  }\n\n  addAvatar(data) {\n    const body = {\n      avatar: data.avatar,\n    }\n    return fetch(`${this._url}/users/me/avatar`, {\n      method: 'PATCH',\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      },\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n }\n\n export const api = new Api('http://localhost:3000')\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}