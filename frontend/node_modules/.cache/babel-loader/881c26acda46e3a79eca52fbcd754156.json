{"ast":null,"code":"import _classCallCheck from\"C:/Users/mi/dev/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/mi/dev/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";var Api=/*#__PURE__*/function(){function Api(url,token){_classCallCheck(this,Api);this._getToken=function(){return localStorage.getItem('jwt');};this._url=url;this._token=token;}_createClass(Api,[{key:\"_checkServerResponse\",value:// _getToken = (token) => {\n//   localStorage.getItem('jwt');\n//   console.log('localStorage:', localStorage.jwt)\n// } \nfunction _checkServerResponse(res){if(res.ok){return res.json();}return Promise.reject('Возникла ошибка');}},{key:\"getAllNeededData\",value:function getAllNeededData(){return Promise.all([this.getProfile(),this.getInitialCards()]);}},{key:\"getInitialCards\",value:function getInitialCards(){return fetch(\"\".concat(this._url,\"/cards/\"),{headers:this._headers}).then(this._checkServerResponse);}},{key:\"getProfile\",value:function getProfile(){return fetch(\"\".concat(this._url,\"/users/me\"),{headers:this._headers}).then(this._checkServerResponse);}},{key:\"addProfile\",value:function addProfile(data){var body={name:data.name,about:data.about};return fetch(\"\".concat(this._url,\"/users/me\"),{method:'PATCH',headers:this._headers,body:JSON.stringify(body)}).then(this._checkServerResponse);}},{key:\"addCard\",value:function addCard(data){var body={name:data.name,link:data.link};return fetch(\"\".concat(this._url,\"/cards/\"),{method:'POST',headers:this._headers,body:JSON.stringify(body)}).then(this._checkServerResponse);}},{key:\"deleteCard\",value:function deleteCard(cardId){return fetch(\"\".concat(this._url,\"/cards/\").concat(cardId),{method:'DELETE',headers:this._headers}).then(this._checkServerResponse);}},{key:\"changeLikeCardStatus\",value:function changeLikeCardStatus(cardId,isLiked){return fetch(\"\".concat(this._url,\"/cards/\").concat(cardId,\"/likes\"),{method:\"\".concat(isLiked?'PUT':'DELETE'),headers:this._headers}).then(this._checkServerResponse);}},{key:\"addAvatar\",value:function addAvatar(data){var body={avatar:data.avatar};return fetch(\"\".concat(this._url,\"/users/me/avatar\"),{method:'PATCH',headers:this._headers,body:JSON.stringify(body)}).then(this._checkServerResponse);}}]);return Api;}();export var api=new Api({url:'http://localhost:3000',toke:this._getToken()});","map":{"version":3,"names":["Api","url","token","_getToken","localStorage","getItem","_url","_token","res","ok","json","Promise","reject","all","getProfile","getInitialCards","fetch","headers","_headers","then","_checkServerResponse","data","body","name","about","method","JSON","stringify","link","cardId","isLiked","avatar","api","toke"],"sources":["C:/Users/mi/dev/react-mesto-api-full/frontend/src/utils/api.js"],"sourcesContent":["class Api {\n  constructor(url, token) {\n    this._url = url;\n    this._token = token;\n  }\n\n  _getToken = () => localStorage.getItem('jwt');\n\n  // _getToken = (token) => {\n  //   localStorage.getItem('jwt');\n  //   console.log('localStorage:', localStorage.jwt)\n  // } \n\n\n  _checkServerResponse(res){\n    if (res.ok) {\n      return res.json();\n    }\n    return Promise.reject('Возникла ошибка')\n  }\n\n  getAllNeededData() {\n    return Promise.all([this.getProfile(), this.getInitialCards()])\n  }\n\n  getInitialCards() {\n    return fetch(`${this._url}/cards/`, {\n      headers: this._headers\n    })\n      .then(this._checkServerResponse)\n  }\n\n  getProfile() {\n    return fetch(`${this._url}/users/me`, {\n      headers: this._headers\n    })\n      .then(this._checkServerResponse)\n  }\n\n  addProfile(data) {\n    const body = {\n      name: data.name,\n      about: data.about\n    }\n    return fetch(`${this._url}/users/me`, {\n      method: 'PATCH',\n      headers: this._headers,\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n\n  addCard(data) {\n    const body = {\n      name: data.name,\n      link: data.link\n    }\n    return fetch(`${this._url}/cards/`, {\n      method: 'POST',\n      headers: this._headers,\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n\n  deleteCard(cardId) {\n    return fetch(`${this._url}/cards/${cardId}`, {\n      method: 'DELETE',\n      headers: this._headers,\n    })\n    .then(this._checkServerResponse)\n  }\n\n  changeLikeCardStatus(cardId, isLiked) {\n    return fetch(`${this._url}/cards/${cardId}/likes`, {\n      method: `${isLiked ? 'PUT' : 'DELETE'}`,\n      headers: this._headers,\n    })\n    .then(this._checkServerResponse)\n  }\n\n  addAvatar(data) {\n    const body = {\n      avatar: data.avatar,\n    }\n    return fetch(`${this._url}/users/me/avatar`, {\n      method: 'PATCH',\n      headers: this._headers,\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n }\n\n export const api = new Api({\n  url: 'http://localhost:3000',\n  toke: this._getToken(),\n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}