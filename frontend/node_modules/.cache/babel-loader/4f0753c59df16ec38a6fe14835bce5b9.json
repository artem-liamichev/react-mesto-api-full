{"ast":null,"code":"import _objectSpread from\"C:/Users/mi/dev/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"C:/Users/mi/dev/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/mi/dev/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import{CurrenUserContext}from'../contexts/CurrentUserContext.js';var Api=/*#__PURE__*/function(){function Api(url){_classCallCheck(this,Api);this._getToken=function(){return localStorage.getItem('jwt');};this._url=url;this._headers={'Accept':'application/json','Content-type':'application/json'};}_createClass(Api,[{key:\"_checkServerResponse\",value:function _checkServerResponse(res){if(res.ok){return res.json();}return Promise.reject('Возникла ошибка');}},{key:\"getAllNeededData\",value:function getAllNeededData(){return Promise.all([this.getProfile(),this.getInitialCards()]);}},{key:\"getInitialCards\",value:function getInitialCards(){return fetch(\"\".concat(this._url,\"/cards/\"),{headers:_objectSpread(_objectSpread({},this._headers),{},{'Authorization':\"Bearer \".concat(this._getToken())})}).then(this._checkServerResponse);}},{key:\"getProfile\",value:function getProfile(){return fetch(\"\".concat(this._url,\"/users/me\"),{headers:_objectSpread(_objectSpread({},this._headers),{},{'Authorization':\"Bearer \".concat(this._getToken())})}).then(this._checkServerResponse);}},{key:\"addProfile\",value:function addProfile(data){var body={data:data};return fetch(\"\".concat(this._url,\"/users/me\"),{method:'PATCH',headers:_objectSpread(_objectSpread({},this._headers),{},{'Authorization':\"Bearer \".concat(this._getToken())}),body:JSON.stringify(body)}).then(this._checkServerResponse);}},{key:\"addCard\",value:function addCard(newCard){var body={name:newCard.name,link:newCard.link};return fetch(\"\".concat(this._url,\"/cards/\"),{method:'POST',headers:_objectSpread(_objectSpread({},this._headers),{},{'Authorization':\"Bearer \".concat(this._getToken())}),body:JSON.stringify(body)}).then(this._checkServerResponse);}},{key:\"deleteCard\",value:function deleteCard(cardId){return fetch(\"\".concat(this._url,\"/cards/\").concat(cardId),{method:'DELETE',headers:_objectSpread(_objectSpread({},this._headers),{},{'Authorization':\"Bearer \".concat(this._getToken())})}).then(this._checkServerResponse);}},{key:\"changeLikeCardStatus\",value:function changeLikeCardStatus(cardId,isLiked){return fetch(\"\".concat(this._url,\"/cards/\").concat(cardId,\"/likes\"),{method:\"\".concat(isLiked?'PUT':'DELETE'),headers:_objectSpread(_objectSpread({},this._headers),{},{'Authorization':\"Bearer \".concat(this._getToken())})}).then(this._checkServerResponse);}},{key:\"addAvatar\",value:function addAvatar(data){var body={avatar:data.avatar};return fetch(\"\".concat(this._url,\"/users/me/avatar\"),{method:'PATCH',headers:_objectSpread(_objectSpread({},this._headers),{},{'Authorization':\"Bearer \".concat(this._getToken())}),body:JSON.stringify(body)}).then(this._checkServerResponse);}}]);return Api;}();export var api=new Api('http://localhost:3000');","map":{"version":3,"names":["CurrenUserContext","Api","url","_getToken","localStorage","getItem","_url","_headers","res","ok","json","Promise","reject","all","getProfile","getInitialCards","fetch","headers","then","_checkServerResponse","data","body","method","JSON","stringify","newCard","name","link","cardId","isLiked","avatar","api"],"sources":["C:/Users/mi/dev/react-mesto-api-full/frontend/src/utils/api.js"],"sourcesContent":["import { CurrenUserContext } from '../contexts/CurrentUserContext.js';\n\nclass Api {\n  constructor(url) {\n    this._url = url;\n    this._headers = {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n    }\n  }\n\n  _getToken = () => localStorage.getItem('jwt');\n\n  _checkServerResponse(res){\n    if (res.ok) {\n      return res.json();\n    }\n    return Promise.reject('Возникла ошибка')\n  }\n\n  getAllNeededData() {\n    return Promise.all([this.getProfile(), this.getInitialCards()])\n  }\n\n  getInitialCards() {\n    return fetch(`${this._url}/cards/`, {\n      headers: {\n      ...this._headers,\n      'Authorization': `Bearer ${this._getToken()}`,\n    }\n    })\n      .then(this._checkServerResponse)\n  }\n\n  getProfile() {\n    return fetch(`${this._url}/users/me`, {\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      }\n    })\n      .then(this._checkServerResponse)\n  }\n\n  addProfile(data) {\n    const body = {data}\n    return fetch(`${this._url}/users/me`, {\n      method: 'PATCH',\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      },\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n\n  addCard(newCard) {\n    const body = {\n      name: newCard.name,\n      link: newCard.link\n    }\n    return fetch(`${this._url}/cards/`, {\n      method: 'POST',\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      },\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n\n  deleteCard(cardId) {\n    return fetch(`${this._url}/cards/${cardId}`, {\n      method: 'DELETE',\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      }    })\n    .then(this._checkServerResponse)\n  }\n\n  changeLikeCardStatus(cardId, isLiked) {\n    return fetch(`${this._url}/cards/${cardId}/likes`, {\n      method: `${isLiked ? 'PUT' : 'DELETE'}`,\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      }\n    })\n    .then(this._checkServerResponse)\n  }\n\n  addAvatar(data) {\n    const body = {\n      avatar: data.avatar,\n    }\n    return fetch(`${this._url}/users/me/avatar`, {\n      method: 'PATCH',\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      },\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n }\n\n export const api = new Api('http://localhost:3000')\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}