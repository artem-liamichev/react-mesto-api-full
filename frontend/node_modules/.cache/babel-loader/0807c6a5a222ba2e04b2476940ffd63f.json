{"ast":null,"code":"import _objectSpread from\"C:/Users/mi/dev/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"C:/Users/mi/dev/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/mi/dev/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";var Api=/*#__PURE__*/function(){function Api(url,token){_classCallCheck(this,Api);this._getToken=function(){return localStorage.getItem('jwt');};this._url=url;this._token=token;this._headers={'Accept':'application/json','Content-type':'application/json'};}_createClass(Api,[{key:\"_checkServerResponse\",value:// _getToken = (token) => {\n//   localStorage.get('jwt');\n//   console.log('localStorage:', localStorage.jwt)\n// } \nfunction _checkServerResponse(res){if(res.ok){return res.json();}return Promise.reject('Возникла ошибка');}},{key:\"getAllNeededData\",value:function getAllNeededData(){return Promise.all([this.getProfile(),this.getInitialCards()]);}},{key:\"getInitialCards\",value:function getInitialCards(){return fetch(\"\".concat(this._url,\"/cards/\"),{headers:_objectSpread(_objectSpread({},this._headers),{},{'Authorization':\"Bearer \".concat(this._getToken())})}).then(this._checkServerResponse);}},{key:\"getProfile\",value:function getProfile(){return fetch(\"\".concat(this._url,\"/users/me\"),{headers:_objectSpread(_objectSpread({},this._headers),{},{'Authorization':\"Bearer \".concat(this._getToken())})}).then(this._checkServerResponse);}},{key:\"addProfile\",value:function addProfile(data){var body={name:data.name,about:data.about};return fetch(\"\".concat(this._url,\"/users/me\"),{method:'PATCH',headers:_objectSpread(_objectSpread({},this._headers),{},{'Authorization':\"Bearer \".concat(this._getToken())}),body:JSON.stringify(body)}).then(this._checkServerResponse);}},{key:\"addCard\",value:function addCard(data){var body={name:data.name,link:data.link};return fetch(\"\".concat(this._url,\"/cards/\"),{method:'POST',headers:this._headers,body:JSON.stringify(body)}).then(this._checkServerResponse);}},{key:\"deleteCard\",value:function deleteCard(cardId){return fetch(\"\".concat(this._url,\"/cards/\").concat(cardId),{method:'DELETE',headers:this._headers}).then(this._checkServerResponse);}},{key:\"changeLikeCardStatus\",value:function changeLikeCardStatus(cardId,isLiked){return fetch(\"\".concat(this._url,\"/cards/\").concat(cardId,\"/likes\"),{method:\"\".concat(isLiked?'PUT':'DELETE'),headers:this._headers}).then(this._checkServerResponse);}},{key:\"addAvatar\",value:function addAvatar(data){var body={avatar:data.avatar};return fetch(\"\".concat(this._url,\"/users/me/avatar\"),{method:'PATCH',headers:this._headers,body:JSON.stringify(body)}).then(this._checkServerResponse);}}]);return Api;}();export var api=new Api('http://localhost:3000');","map":{"version":3,"names":["Api","url","token","_getToken","localStorage","getItem","_url","_token","_headers","res","ok","json","Promise","reject","all","getProfile","getInitialCards","fetch","headers","then","_checkServerResponse","data","body","name","about","method","JSON","stringify","link","cardId","isLiked","avatar","api"],"sources":["C:/Users/mi/dev/react-mesto-api-full/frontend/src/utils/api.js"],"sourcesContent":["class Api {\n  constructor(url, token) {\n    this._url = url;\n    this._token = token;\n    this._headers = {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n    }\n  }\n\n  _getToken = () => localStorage.getItem('jwt');\n\n  // _getToken = (token) => {\n  //   localStorage.get('jwt');\n  //   console.log('localStorage:', localStorage.jwt)\n  // } \n\n\n  _checkServerResponse(res){\n    if (res.ok) {\n      return res.json();\n    }\n    return Promise.reject('Возникла ошибка')\n  }\n\n  getAllNeededData() {\n    return Promise.all([this.getProfile(), this.getInitialCards()])\n  }\n\n  getInitialCards() {\n    return fetch(`${this._url}/cards/`, {\n      headers: {\n      ...this._headers,\n      'Authorization': `Bearer ${this._getToken()}`,\n    }\n    })\n      .then(this._checkServerResponse)\n  }\n\n  getProfile() {\n    return fetch(`${this._url}/users/me`, {\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      }\n    })\n      .then(this._checkServerResponse)\n  }\n\n  addProfile(data) {\n    const body = {\n      name: data.name,\n      about: data.about\n    }\n    return fetch(`${this._url}/users/me`, {\n      method: 'PATCH',\n      headers: {\n        ...this._headers,\n        'Authorization': `Bearer ${this._getToken()}`,\n      },\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n\n  addCard(data) {\n    const body = {\n      name: data.name,\n      link: data.link\n    }\n    return fetch(`${this._url}/cards/`, {\n      method: 'POST',\n      headers: this._headers,\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n\n  deleteCard(cardId) {\n    return fetch(`${this._url}/cards/${cardId}`, {\n      method: 'DELETE',\n      headers: this._headers,\n    })\n    .then(this._checkServerResponse)\n  }\n\n  changeLikeCardStatus(cardId, isLiked) {\n    return fetch(`${this._url}/cards/${cardId}/likes`, {\n      method: `${isLiked ? 'PUT' : 'DELETE'}`,\n      headers: this._headers,\n    })\n    .then(this._checkServerResponse)\n  }\n\n  addAvatar(data) {\n    const body = {\n      avatar: data.avatar,\n    }\n    return fetch(`${this._url}/users/me/avatar`, {\n      method: 'PATCH',\n      headers: this._headers,\n      body: JSON.stringify(body)\n})\n    .then(this._checkServerResponse)\n  }\n }\n\n export const api = new Api('http://localhost:3000');\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}